<head></head>
<style>
    table,
    th,
    td {
        border: 1px solid black;
    }
</style>
</head>

<body onload="initializeTable()"></body>
<h3>Available Beds and Waiting List</h3>
<p></p>
<table style="width:100%">
    <tr>
        <th> Shelter Location </th>
        <th> Capacity </th>
        <th> Available Beds </th>
        <th> Waiting List </th>
        <th> Last Update </th>
    </tr>
    <tr>
        <td>Blanchet House - Old Town</td>
        <td id="8bbfa9f8-636f-4821-8f4a-76f2c3d36f04-capacity">0</td>
        <td id="8bbfa9f8-636f-4821-8f4a-76f2c3d36f04-beds">0</td>
        <td id="8bbfa9f8-636f-4821-8f4a-76f2c3d36f04-waiting">0</td>
        <td id="8bbfa9f8-636f-4821-8f4a-76f2c3d36f04-update">-</td>
    </tr>
    <tr>
        <td>Blanchet Farm - Yamhill County</td>
        <td id="e3603e3b-c650-46f4-9885-8d345d873945-capacity">0</td>
        <td id="e3603e3b-c650-46f4-9885-8d345d873945-beds">0</td>
        <td id="e3603e3b-c650-46f4-9885-8d345d873945-waiting">0</td>
        <td id="e3603e3b-c650-46f4-9885-8d345d873945-update">-</td>
    </tr>
    <tr>
        <td>Banfield Shelter Motel</td>
        <td id="1e4e5e20-aece-41e3-b444-bb3f19a73c93-capacity">0</td>
        <td id="1e4e5e20-aece-41e3-b444-bb3f19a73c93-beds">0</td>
        <td id="1e4e5e20-aece-41e3-b444-bb3f19a73c93-waiting">0</td>
        <td id="1e4e5e20-aece-41e3-b444-bb3f19a73c93-update">-</td>
    </tr>
    <tr>
        <td>Clark Center</td>
        <td id="6018c2ba-ee36-4ac9-9dfb-9df5cd3f6d90-capacity">0</td>
        <td id="6018c2ba-ee36-4ac9-9dfb-9df5cd3f6d90-beds">0</td>
        <td id="6018c2ba-ee36-4ac9-9dfb-9df5cd3f6d90-waiting">0</td>
        <td id="6018c2ba-ee36-4ac9-9dfb-9df5cd3f6d90-update">-</td>
    </tr>
    <tr>
        <td>Doreen's Place</td>
        <td id="baec99fb-6c5b-4d10-b755-31a75e1bd7d5-capacity">0</td>
        <td id="baec99fb-6c5b-4d10-b755-31a75e1bd7d5-beds">0</td>
        <td id="baec99fb-6c5b-4d10-b755-31a75e1bd7d5-waiting">0</td>
        <td id="baec99fb-6c5b-4d10-b755-31a75e1bd7d5-update">-</td>
    </tr>
    <tr>
        <td>Jean's Place</td>
        <td id="883fb326-3cb1-4941-9ebb-ac792349d054-capacity">0</td>
        <td id="883fb326-3cb1-4941-9ebb-ac792349d054-beds">0</td>
        <td id="883fb326-3cb1-4941-9ebb-ac792349d054-waiting">0</td>
        <td id="883fb326-3cb1-4941-9ebb-ac792349d054-update">-</td>
    </tr>
    <tr>
        <td>Laurelwood Center</td>
        <td id="0c143d32-8f50-4a75-a214-9428cb33c89f-capacity">0</td>
        <td id="0c143d32-8f50-4a75-a214-9428cb33c89f-beds">0</td>
        <td id="0c143d32-8f50-4a75-a214-9428cb33c89f-waiting">0</td>
        <td id="0c143d32-8f50-4a75-a214-9428cb33c89f-update">-</td>
    </tr>
    <tr>
        <td>River District Navigation Center</td>
        <td id="8dc6426f-a2d4-4cbd-a420-88835528f87f-capacity">0</td>
        <td id="8dc6426f-a2d4-4cbd-a420-88835528f87f-beds">0</td>
        <td id="8dc6426f-a2d4-4cbd-a420-88835528f87f-waiting">0</td>
        <td id="8dc6426f-a2d4-4cbd-a420-88835528f87f-update">-</td>
    </tr>
    <tr>
        <td>Walnut Park Shelter</td>
        <td id="d7b5c422-d6aa-43ad-9d79-3d6ded34a8fa-capacity">0</td>
        <td id="d7b5c422-d6aa-43ad-9d79-3d6ded34a8fa-beds">0</td>
        <td id="d7b5c422-d6aa-43ad-9d79-3d6ded34a8fa-waiting">0</td>
        <td id="d7b5c422-d6aa-43ad-9d79-3d6ded34a8fa-update">-</td>
    </tr>
    <tr>
        <td>Willamette Center</td>
        <td id="59678093-2bd3-451f-8a40-0aa6ce003da2-capacity">0</td>
        <td id="59678093-2bd3-451f-8a40-0aa6ce003da2-beds">0</td>
        <td id="59678093-2bd3-451f-8a40-0aa6ce003da2-waiting">0</td>
        <td id="59678093-2bd3-451f-8a40-0aa6ce003da2-update">-</td>
    </tr>
</table>
<p></p>

<script>
    async function initializeTable() {
        const sites = [
            '8bbfa9f8-636f-4821-8f4a-76f2c3d36f04',
            'e3603e3b-c650-46f4-9885-8d345d873945',
            '1e4e5e20-aece-41e3-b444-bb3f19a73c93',
            '6018c2ba-ee36-4ac9-9dfb-9df5cd3f6d90',
            'baec99fb-6c5b-4d10-b755-31a75e1bd7d5',
            '883fb326-3cb1-4941-9ebb-ac792349d054',
            '0c143d32-8f50-4a75-a214-9428cb33c89f',
            '8dc6426f-a2d4-4cbd-a420-88835528f87f',
            'd7b5c422-d6aa-43ad-9d79-3d6ded34a8fa',
            '59678093-2bd3-451f-8a40-0aa6ce003da2'
        ]

        for (let i = 0; i < sites.length; i++) {
            const result = await getbeds(sites[i]);
            const beds = result.available;
            console.log(result);
            document.getElementById(sites[i] + '-capacity').innerText = result.capacity;
            document.getElementById(sites[i] + '-beds').innerText = beds;
            document.getElementById(sites[i] + '-waiting').innerText = result.waiting;
            if (!result.updateTime) {
                document.getElementById(sites[i] + '-update').innerText = '-';
            } else {
                const updateTime = new Date(result.updateTime).toLocaleString();
                document.getElementById(sites[i] + '-update').innerText = updateTime;
            }
        }

        clearBedsInput();
    }

    // offical
    const backendUrl = 'https://eufv359foj.execute-api.us-west-2.amazonaws.com/stage/shelter/available/v1/';
    // test
    // const backendUrl = 'https://b6nwicd289.execute-api.us-west-2.amazonaws.com/stage/shelter/available/v1/';

    async function getbeds(location) {
        const response = await fetch(backendUrl + location, {
            method: 'GET',
            mode: 'cors',
            headers: {
                'Content-Type': 'application/json'
            }
        });
        const data = await response.json();
        console.log(data)
        return {
            capacity: data.capacity,
            available: data.available,
            waiting: data.waiting,
            updateTime: data.updateTime
        }
    }

</script>
</body>